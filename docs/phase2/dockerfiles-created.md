# Phase 2, –≠—Ç–∞–ø 1: Docker –æ–±—Ä–∞–∑—ã —Å–æ–∑–¥–∞–Ω—ã

–î–∞—Ç–∞: 2025-11-19

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. `app/Dockerfile`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Docker –æ–±—Ä–∞–∑ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ú–Ω–æ–≥–æ—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞ (dependencies ‚Üí build ‚Üí runtime)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç pnpm workspaces
- Production-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `pnpm start` (Next.js production server)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
1. **base** - –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å Node.js 22 –∏ pnpm
2. **dependencies** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **build** - —Å–±–æ—Ä–∫–∞ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. **runtime** - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ —Å production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `API_URL` - URL API Gateway
- `LANDING_URL` - URL –ª–µ–Ω–¥–∏–Ω–≥–∞
- `NODE_ENV=production`
- `PORT=3000`
- `HOSTNAME=0.0.0.0`

---

### 2. `landing/Dockerfile`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Docker –æ–±—Ä–∞–∑ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–µ–Ω–¥–∏–Ω–≥–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Static export Next.js (`output: 'export'`)
- Nginx –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ —Å—Ç–∞—Ç–∏–∫–∏
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ (nginx:alpine)
- Build-time –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
1. **base** - –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å Node.js 22 –∏ pnpm
2. **dependencies** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **build** - —Å–±–æ—Ä–∫–∞ Next.js static export
4. **runtime** - nginx —Å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (build-time):**
- `APP_URL` - URL –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### 3. `landing/nginx.conf`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∞–π—Ç–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Gzip compression
- Security headers
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Next.js —Å—Ç–∞—Ç–∏–∫–∏
- Health check endpoint (`/health`)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

---

### 4. `.dockerignore` —Ñ–∞–π–ª—ã
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤

**–ò—Å–∫–ª—é—á–∞—é—Ç—Å—è:**
- `node_modules`
- `.next` / `out`
- `.git`
- `README.md` –∏ –¥—Ä—É–≥–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `.env*` —Ñ–∞–π–ª—ã

---

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ app
docker build -t maratea-app:test -f app/Dockerfile .

# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ landing
docker build -t maratea-landing:test -f landing/Dockerfile .

# –ó–∞–ø—É—Å–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
docker run -p 3000:3000 -e API_URL=http://localhost:8080 maratea-app:test
docker run -p 8080:80 maratea-landing:test
```

### –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≠—Ç–∞–ø—É 2

–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø: —Å–æ–∑–¥–∞–Ω–∏–µ Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤
- Deployment –¥–ª—è `app`
- Deployment –¥–ª—è `landing`
- Services
- Network Policies

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

- ‚úÖ Dockerfile –¥–ª—è `app` —Å–æ–∑–¥–∞–Ω
- ‚úÖ Dockerfile –¥–ª—è `landing` —Å–æ–∑–¥–∞–Ω
- ‚úÖ nginx.conf —Å–æ–∑–¥–∞–Ω
- ‚úÖ .dockerignore —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚è≥ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **Next.js production server:**
   - `app` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `next start` –¥–ª—è production
   - –¢—Ä–µ–±—É–µ—Ç `.next` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ `next build`

2. **Static export:**
   - `landing` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `output: 'export'` –≤ `next.config.js`
   - –°–æ–∑–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –≤ `out/`
   - Nginx —Ä–∞–∑–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏–∫—É

3. **Workspace dependencies:**
   - –û–±–∞ Dockerfile —É—á–∏—Ç—ã–≤–∞—é—Ç pnpm workspaces
   - –ö–æ–ø–∏—Ä—É—é—Ç `shared` package –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

