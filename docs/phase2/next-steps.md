# Phase 2: –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–î–∞—Ç–∞: 2025-11-19

## üìã –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –∑–∞–ø–∏—Å–∏ (–≤—Ä—É—á–Ω—É—é) ‚è≥

**–¢—Ä–µ–±—É–µ–º—ã–µ DNS –∑–∞–ø–∏—Å–∏:**

1. **app.staging.betaserver.ru** ‚Üí `62.76.233.233`
   - –¢–∏–ø: A
   - TTL: 300 (–∏–ª–∏ –º–µ–Ω—å—à–µ)
   - –ò–º—è/–•–æ—Å—Ç: `app.staging`

2. **staging.betaserver.ru** ‚Üí `62.76.233.233`
   - –¢–∏–ø: A
   - TTL: 300 (–∏–ª–∏ –º–µ–Ω—å—à–µ)
   - –ò–º—è/–•–æ—Å—Ç: `staging` (–∏–ª–∏ `@` –¥–ª—è –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞)

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DNS –¥–ª—è `betaserver.ru`
2. –°–æ–∑–¥–∞–π—Ç–µ A –∑–∞–ø–∏—Å–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è DNS (5-15 –º–∏–Ω—É—Ç)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ DNS:**
```bash
dig +short app.staging.betaserver.ru
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 62.76.233.233

dig +short staging.betaserver.ru
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 62.76.233.233
```

---

### 2. –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS ‚úÖ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**

1. **cert-manager –ø–æ–ª—É—á–∏—Ç TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:**
   - Certificate `app-tls` –¥–ª—è `app.staging.betaserver.ru`
   - Certificate `landing-tls` –¥–ª—è `staging.betaserver.ru`
   - –í—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è: 1-2 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ DNS

2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å—Ç–∞–Ω—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTPS:**
   - `https://app.staging.betaserver.ru`
   - `https://staging.betaserver.ru`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:**
```bash
kubectl get certificates -n maratea
kubectl describe certificate app-tls -n maratea
kubectl describe certificate landing-tls -n maratea
```

---

### 3. –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ push –≤ GitHub üöÄ

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**

1. **GitHub Actions workflow –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è:**
   - –°–æ–±–µ—Ä—É—Ç—Å—è Docker –æ–±—Ä–∞–∑—ã –¥–ª—è:
     - `api-gateway`
     - `app`
     - `landing`
   - –û–±—Ä–∞–∑—ã –∑–∞–ø—É—à—É—Ç—Å—è –≤ GHCR —Å —Ç–µ–≥–∞–º–∏:
     - `:${{ github.sha }}` (—Ç–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è)
     - `:latest` (–ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è)

2. **Deployments –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –≤ Kubernetes:**
   - `deployment/app` (2 replicas)
   - `deployment/landing` (1 replica)
   - `deployment/api-gateway` (2 replicas)

3. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥—É—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã:**
   - –ü–æ—Å–ª–µ rollout pods –±—É–¥—É—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ Running
   - Health checks –ø—Ä–æ–π–¥—É—Ç —É—Å–ø–µ—à–Ω–æ
   - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ Ingress

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è:**
```bash
kubectl get pods -n maratea
kubectl get deployments -n maratea
kubectl get services -n maratea
kubectl get ingress -n maratea
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
./scripts/verify-phase2-status.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- DNS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
- TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –°—Ç–∞—Ç—É—Å deployments
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

‚úÖ **DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω:**
- `app.staging.betaserver.ru` ‚Üí `62.76.233.233`
- `staging.betaserver.ru` ‚Üí `62.76.233.233`

‚úÖ **TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã:**
- `app-tls` Secret —Å–æ–∑–¥–∞–Ω
- `landing-tls` Secret —Å–æ–∑–¥–∞–Ω

‚úÖ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã:**
- `app` –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `https://app.staging.betaserver.ru`
- `landing` –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `https://staging.betaserver.ru`
- `api-gateway` –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `https://api.staging.betaserver.ru`

‚úÖ **CI/CD —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –≤ Kubernetes
- Health checks –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

---

## üéâ Phase 2 –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ Phase 2 –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ Phase 3 (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤).

